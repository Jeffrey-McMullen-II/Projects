<?xml version="1.0" encoding="UTF-8"?>

<!--
    Extra links provided to fix NetBeans bug with <mvc:annotation-driven/>
-->
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:mvc="http://www.springframework.org/schema/mvc"
	xmlns:context="http://www.springframework.org/schema/context"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="
        http://www.springframework.org/schema/beans
        http://www.springframework.org/schema/beans/spring-beans.xsd
        http://www.springframework.org/schema/mvc 
        http://www.springframework.org/schema/mvc/spring-mvc.xsd
        http://www.springframework.org/schema/context 
        http://www.springframework.org/schema/context/spring-context.xsd">

    <!--
        Declares explicit support for annotation-driven MVC controllers
        including declarative validation support via @Valid annotation.
    -->
    <mvc:annotation-driven/>
    
    <!--
        Directs the front controller to look in the base-package listed below
        to find controllers that respond to particular web pages being opened.
    -->
    <context:component-scan base-package="com.jaygames_spring_mvc.controllers"/> 
    

    
    <!--
        Directs the controller to listed location to include css files and images.
    -->
    <mvc:resources mapping="/css/**" location="/WEB-INF/resources/css/" />
    <mvc:resources mapping="/images/**" location="/WEB-INF/resources/images/" />
    
    <!--
        Tells the front controller to start here before processing any requests.
    -->
    <mvc:interceptors>
        <!--
            This particular interceptor will only be processed when admissionForm
            page is opened and will prevent the page from loading depending on
            the current day of the week.
        -->
        <mvc:interceptor>
            <mvc:mapping path="/admissionForm.html"/>
            <bean class="com.jaygames_spring_mvc.controllers_practice.DayOfWeekInterceptor"/>
        </mvc:interceptor>
        
        <!--
            This interceptor changes the site language depending on what link
            the user clicked in the Student Submission Form. See "localeResolver"
            bean below.
        -->
        <bean class="org.springframework.web.servlet.i18n.LocaleChangeInterceptor">
            <property name="paramName" value="siteLanguage"/>
        </bean>
    </mvc:interceptors>
    
    <!--
        This is the front controller that subsequent controller classes we create
        will have to rely on in order to reach webpages that they are directed to.
    -->
    <bean id="viewResolver"
          class="org.springframework.web.servlet.view.InternalResourceViewResolver">
        <property name="prefix">
            <value>/WEB-INF/views/</value>
        </property>
        <property name="suffix">
            <value>.jsp</value>
        </property>
    </bean>
    
    <!-- 
        Requirement added for Beans to pull form validation messages from
        Student_Form_Messages.properties file.
    -->
    <bean id="messageSource"
        class = "org.springframework.context.support.ReloadableResourceBundleMessageSource">
        <property name="basename" value="/WEB-INF/properties/practice/Student_Form_Messages"/>
        
        <!-- 
            Makes server restart no longer necessary by loading changes made to
            properties files once every 3 seconds back to the server. Reccomended
            only when in development environment but not production environment.
        -->
        <property name="cacheSeconds" value="3"/> 
        
    </bean>
    
    <!--
        Required in order for LocaleChangeInterceptor to work.
    -->
    <bean id="localeResolver" class="org.springframework.web.servlet.i18n.CookieLocaleResolver">
        <!-- <property name="defaultLocale" value="en"/> While disabled, browser language preference will be used. -->
        <property name="cookieName" value="localeCookie"/>
        <property name="cookieMaxAge" value="3600"/>
    </bean>
</beans>
